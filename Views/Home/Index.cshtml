@model ICollection<ShumenNews.Models.ViewModels.ArticleViewModel>
@{
    ViewData["Title"] = "Home Page";
}
<section class="mb-5">
    <!--Carousel-->
    <div id="carouselExampleCaptions" class="carousel slide mt-5">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            @for (int i = 1; i < 3; i++)
            {
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="@i" aria-label="Slide @i"></button>
            }
        </div>
        <div class="carousel-inner">
            @for (int i = 0; i < 3; i++)
            {
                @if (i == 0)
                {
                    <div class="carousel-item active">
                        <a asp-area="" asp-controller="Articles" asp-action="Index" asp-route-id="@Model.Where(a=>a.Category.Id == "Week").ElementAtOrDefault(i)!.Id">
                            <img src="@Model.Where(a=>a.Category.Id == "Week").ElementAtOrDefault(i)!.MainImage" class="d-block w-100" alt="image" height="400">
                            <div class="carousel-caption d-none d-md-block">
                                <h5>@Model.Where(a => a.Category.Id == "Week").ElementAtOrDefault(i)!.Title</h5>
                                <p>
                                    Дата: @Model.Where(a => a.Category.Id == "Week").ElementAtOrDefault(i)!.PublishedOn.ToLongDateString() |
                                    @Model.Where(a => a.Category.Id == "Week").ElementAtOrDefault(i)!.LikesCount харесвания |
                                    @Model.Where(a => a.Category.Id == "Week").ElementAtOrDefault(i)!.ViewsCount преглеждания
                                </p>
                            </div>
                        </a>
                    </div>
                }
                else
                {
                    <div class="carousel-item">
                        <a asp-area="" asp-controller="Articles" asp-action="Index" asp-route-id="@Model.Where(a=>a.Category.Id == "Week").ElementAtOrDefault(i)!.Id">
                            <img src="@Model.Where(a=>a.Category.Id == "Week").ElementAtOrDefault(i)!.MainImage" class="d-block w-100" alt="image" height="400">
                            <div class="carousel-caption d-none d-md-block">
                                <h5>@Model.Where(a => a.Category.Id == "Week").ElementAtOrDefault(i)!.Title</h5>
                                <p>
                                    Дата: @Model.Where(a => a.Category.Id == "Week").ElementAtOrDefault(i)!.PublishedOn.ToLongDateString() |
                                    @Model.Where(a => a.Category.Id == "Week").ElementAtOrDefault(i)!.LikesCount харесвания |
                                    @Model.Where(a => a.Category.Id == "Week").ElementAtOrDefault(i)!.ViewsCount преглеждания
                                </p>
                            </div>
                        </a>
                    </div>
                }
            }
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
    <!--Cards-->
    @foreach (var category in Model.Select(a => a.Category).Distinct())
    {
        <div class="d-flex">Категория: @category.Name</div>
        <div class="d-flex justify-content-center my-3">
            @foreach (var article in category.Articles)
            {
                <div class="card mx-2" style="width: 18rem;">
                    <img src="@article.Images.First(i=>i.Id == article.MainImageId).Url" class="card-img-top" alt="image" width="250" height="200">
                    <div class="card-body">
                        <h5 class="card-title">@article.Title</h5>
                        <h6 class="card-title">
                            преди @article.PublishedOn.ToShortDateString()
                            | харесвания @article.LikesCount
                            | преглеждания @article.ViewsCount
                        </h6>
                        <p class="card-text">@article.Content</p>
                        <!--Links-->
                        <a class="btn bg-secondary-color text-white" asp-area="" asp-controller="Articles" asp-action="Index" asp-route-id="@article.Id">Прочети</a>
                        @if (User.IsInRole("Admin"))
                        {
                            <a asp-controller="Admin" asp-action="Details" asp-route-id="@article.Id"><i class="fas fa-edit"></i></a>
                        }
                    </div>
                </div>
            }
        </div>
    }
</section>